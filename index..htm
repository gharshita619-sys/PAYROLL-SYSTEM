<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Payroll Management System</title>
    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:Arial,Helvetica,sans-serif;background:#f4f6f9;color:#333}
        header{background:#2c3e50;color:#ecf0f1;padding:15px 30px;text-align:center}
        header h1{margin-bottom:5px}
        header p{font-size:13px;opacity:.8}
        .container{max-width:1100px;margin:30px auto;background:#fff;padding:20px 25px 30px;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,.08)}
        .login-box,.main-app{max-width:420px;margin:0 auto}
        h2.section-title{font-size:22px;margin-bottom:15px;border-bottom:2px solid #3498db;padding-bottom:5px}
        .form-group{margin-bottom:12px}
        .form-group label{display:block;font-size:14px;margin-bottom:4px}
        .form-group input,.form-group select,.form-group textarea{width:100%;padding:7px 9px;border-radius:4px;border:1px solid #ccc;font-size:13px}
        button{background:#3498db;color:#fff;border:none;padding:8px 14px;border-radius:4px;font-size:13px;cursor:pointer}
        button.secondary{background:#7f8c8d}
        button.danger{background:#e74c3c}
        button:hover{opacity:.9}
        .error-msg{color:#e74c3c;font-size:13px;margin-bottom:10px}
        .success-msg{color:#27ae60;font-size:13px;margin-bottom:10px}
        nav{display:flex;gap:10px;margin-bottom:15px;flex-wrap:wrap}
        nav button{background:#ecf0f1;color:#2c3e50;border:1px solid #bdc3c7}
        nav button.active-tab{background:#3498db;color:#fff;border-color:#2980b9}
        .tab-content{display:none;margin-top:5px}
        .tab-content.active{display:block}
        table{width:100%;border-collapse:collapse;margin-top:10px;font-size:13px}
        table th,table td{border:1px solid #ddd;padding:6px 8px;text-align:left}
        table th{background:#ecf0f1}
        .flex-row{display:flex;gap:15px;flex-wrap:wrap}
        .flex-col{flex:1;min-width:260px}
        .badge{display:inline-block;padding:2px 6px;border-radius:4px;font-size:11px;color:#fff}
        .badge.pending{background:#f39c12}
        .badge.approved{background:#27ae60}
        .badge.rejected{background:#c0392b}
        .top-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
        .top-bar span{font-size:13px;color:#555}
        footer{text-align:center;font-size:12px;color:#777;margin:15px 0 25px}
        @media(max-width:600px){.container{margin:15px;padding:15px}}
    </style>
</head>
<body>
<header>
    <h1>Payroll Management System</h1>
    <p>Admin login, employees, attendance, salary and leave</p>
</header>

<div class="container">
    <!-- LOGIN -->
    <div id="loginScreen" class="login-box">
        <h2 class="section-title">Admin Login</h2>
        <div id="loginError" class="error-msg" style="display:none;"></div>
        <div class="form-group">
            <label for="adminUser">Username</label>
            <input type="text" id="adminUser" placeholder="Enter admin username">
        </div>
        <div class="form-group">
            <label for="adminPass">Password</label>
            <input type="password" id="adminPass" placeholder="Enter admin password">
        </div>
        <!-- Demo credentials: adminX9p / P@55w0rdZ9 -->
        <button onclick="handleLogin()">Login</button>
    </div>

    <!-- APP -->
    <div id="appScreen" class="main-app" style="display:none;">
        <div class="top-bar">
            <span>Logged in as: <strong>Admin</strong></span>
            <button class="secondary" onclick="logout()">Logout</button>
        </div>

        <nav>
            <button class="active-tab" onclick="openTab('dashboard',this)">Dashboard</button>
            <button onclick="openTab('employees',this)">Employees</button>
            <button onclick="openTab('attendance',this)">Attendance</button>
            <button onclick="openTab('salary',this)">Salary</button>
            <button onclick="openTab('leaves',this)">Leave Apps</button>
        </nav>

        <!-- DASHBOARD -->
        <div id="tab-dashboard" class="tab-content active">
            <h2 class="section-title">Dashboard</h2>
            <p style="margin-top:5px;font-size:14px;">
                Use the tabs above to manage employees, attendance, salary and leave requests.
            </p>
            <div class="flex-row" style="margin-top:15px;">
                <div class="flex-col">
                    <h3 style="font-size:16px;margin-bottom:5px;">Quick Stats</h3>
                    <ul style="font-size:13px;margin-left:18px;margin-top:5px;line-height:1.7;">
                        <li>Total employees: <span id="statEmployees">0</span></li>
                        <li>Total attendance records: <span id="statAttendance">0</span></li>
                        <li>Pending leave requests: <span id="statPendingLeaves">0</span></li>
                    </ul>
                </div>
                <div class="flex-col">
                    <h3 style="font-size:16px;margin-bottom:5px;">Demo Login</h3>
                    <ul style="font-size:13px;margin-left:18px;margin-top:5px;line-height:1.7;">
                        <li>Username: <code>adminX9p</code></li>
                        <li>Password: <code>P@55w0rdZ9</code></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- EMPLOYEES -->
        <div id="tab-employees" class="tab-content">
            <h2 class="section-title">Employees</h2>
            <div class="flex-row">
                <div class="flex-col">
                    <h3 style="font-size:15px;margin-bottom:8px;">Add / Edit Employee</h3>
                    <div id="empMsg" class="success-msg" style="display:none;"></div>
                    <div class="form-group">
                        <label for="empId">Employee ID</label>
                        <input type="text" id="empId" placeholder="E.g. E001">
                    </div>
                    <div class="form-group">
                        <label for="empName">Full Name</label>
                        <input type="text" id="empName" placeholder="Employee name">
                    </div>
                    <div class="form-group">
                        <label for="empDept">Department</label>
                        <input type="text" id="empDept" placeholder="E.g. HR, IT, Sales">
                    </div>
                    <div class="form-group">
                        <label for="empBaseSalary">Base Salary (per month)</label>
                        <input type="number" id="empBaseSalary" placeholder="E.g. 50000">
                    </div>
                    <button onclick="addOrUpdateEmployee()">Save Employee</button>
                    <button class="danger" onclick="deleteEmployee()">Delete Employee</button>
                </div>
                <div class="flex-col">
                    <h3 style="font-size:15px;margin-bottom:8px;">Employee List</h3>
                    <table>
                        <thead>
                        <tr><th>ID</th><th>Name</th><th>Dept</th><th>Base Salary</th></tr>
                        </thead>
                        <tbody id="empTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ATTENDANCE -->
        <div id="tab-attendance" class="tab-content">
            <h2 class="section-title">Attendance</h2>
            <div class="flex-row">
                <div class="flex-col">
                    <h3 style="font-size:15px;margin-bottom:8px;">Mark Attendance</h3>
                    <div id="attMsg" class="success-msg" style="display:none;"></div>
                    <div class="form-group">
                        <label for="attEmpId">Employee ID</label>
                        <input type="text" id="attEmpId" placeholder="E.g. E001">
                    </div>
                    <div class="form-group">
                        <label for="attDate">Date</label>
                        <input type="date" id="attDate">
                    </div>
                    <div class="form-group">
                        <label for="attStatus">Status</label>
                        <select id="attStatus">
                            <option value="Present">Present</option>
                            <option value="Absent">Absent</option>
                            <option value="Half-day">Half-day</option>
                        </select>
                    </div>
                    <button onclick="markAttendance()">Save Attendance</button>
                </div>
                <div class="flex-col">
                    <h3 style="font-size:15px;margin-bottom:8px;">Recent Attendance</h3>
                    <table>
                        <thead>
                        <tr><th>Emp ID</th><th>Date</th><th>Status</th></tr>
                        </thead>
                        <tbody id="attTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SALARY -->
        <div id="tab-salary" class="tab-content">
            <h2 class="section-title">Salary</h2>
            <div class="flex-row">
                <div class="flex-col">
                    <h3 style="font-size:15px;margin-bottom:8px;">Generate Salary</h3>
                    <p style="font-size:12px;margin-bottom:8px;">
                        Net = Base − (Absent × Base/30) + (Half × Base/60)
                    </p>
                    <div class="form-group">
                        <label for="salEmpId">Employee ID</label>
                        <input type="text" id="salEmpId" placeholder="E.g. E001">
                    </div>
                    <div class="form-group">
                        <label for="salMonth">Month</label>
                        <select id="salMonth">
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="salYear">Year</label>
                        <input type="number" id="salYear" value="2025">
                    </div>
                    <button onclick="calculateSalary()">Calculate</button>
                </div>
                <div class="flex-col">
                    <h3 style="font-size:15px;margin-bottom:8px;">Salary Slip</h3>
                    <div id="salaryResult" style="font-size:13px;line-height:1.6;border:1px solid #ddd;padding:8px;border-radius:4px;min-height:90px;">
                        No salary calculated yet.
                    </div>
                </div>
            </div>
        </div>

        <!-- LEAVES -->
        <div id="tab-leaves" class="tab-content">
            <h2 class="section-title">Leave Applications</h2>
            <div class="flex-row">
                <div class="flex-col">
                    <h3 style="font-size:15px;margin-bottom:8px;">Add Leave Request</h3>
                    <div id="leaveMsg" class="success-msg" style="display:none;"></div>
                    <div class="form-group">
                        <label for="leaveEmpId">Employee ID</label>
                        <input type="text" id="leaveEmpId" placeholder="E.g. E001">
                    </div>
                    <div class="form-group">
                        <label for="leaveType">Leave Type</label>
                        <select id="leaveType">
                            <option value="Casual">Casual</option>
                            <option value="Sick">Sick</option>
                            <option value="Paid">Paid</option>
                            <option value="Unpaid">Unpaid</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="leaveStart">Start Date</label>
                        <input type="date" id="leaveStart">
                    </div>
                    <div class="form-group">
                        <label for="leaveEnd">End Date</label>
                        <input type="date" id="leaveEnd">
                    </div>
                    <div class="form-group">
                        <label for="leaveReason">Reason</label>
                        <textarea id="leaveReason" rows="3" placeholder="Short reason"></textarea>
                    </div>
                    <button onclick="addLeave()">Submit Request</button>
                </div>
                <div class="flex-col">
                    <h3 style="font-size:15px;margin-bottom:8px;">Leave List</h3>
                    <table>
                        <thead>
                        <tr><th>ID</th><th>Type</th><th>Period</th><th>Status</th><th>Action</th></tr>
                        </thead>
                        <tbody id="leaveTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<footer>Demo Payroll Management System &copy; 2025</footer>

<script>
let employees=[],attendance=[],leaves=[];
const DEMO_USER="adminX9p",DEMO_PASS="P@55w0rdZ9";

function handleLogin(){
  const u=document.getElementById("adminUser").value.trim();
  const p=document.getElementById("adminPass").value.trim();
  const err=document.getElementById("loginError");
  if(u===DEMO_USER && p===DEMO_PASS){
    err.style.display="none";
    document.getElementById("loginScreen").style.display="none";
    document.getElementById("appScreen").style.display="block";
    refreshAllTables();
  }else{
    err.textContent="Invalid admin username or password.";
    err.style.display="block";
  }
}
function logout(){
  document.getElementById("loginScreen").style.display="block";
  document.getElementById("appScreen").style.display="none";
  document.getElementById("adminUser").value="";
  document.getElementById("adminPass").value="";
}
function openTab(name,btn){
  document.querySelectorAll(".tab-content").forEach(c=>c.classList.remove("active"));
  document.getElementById("tab-"+name).classList.add("active");
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active-tab"));
  btn.classList.add("active-tab");
  refreshStats();
}
function addOrUpdateEmployee(){
  const id=document.getElementById("empId").value.trim();
  const name=document.getElementById("empName").value.trim();
  const dept=document.getElementById("empDept").value.trim();
  const base=parseFloat(document.getElementById("empBaseSalary").value);
  const msg=document.getElementById("empMsg");
  if(!id||!name||!dept||isNaN(base)){
    msg.textContent="Please fill all employee fields correctly.";
    msg.style.display="block";msg.style.color="#e74c3c";return;
  }
  let ex=employees.find(e=>e.id===id);
  if(ex){ex.name=name;ex.dept=dept;ex.baseSalary=base;msg.textContent="Employee updated successfully.";}
  else{employees.push({id,name,dept,baseSalary:base});msg.textContent="Employee added successfully.";}
  msg.style.display="block";msg.style.color="#27ae60";
  refreshEmpTable();refreshStats();
}
function deleteEmployee(){
  const id=document.getElementById("empId").value.trim();
  const msg=document.getElementById("empMsg");
  if(!id){msg.textContent="Enter an Employee ID to delete.";msg.style.display="block";msg.style.color="#e74c3c";return;}
  const before=employees.length;
  employees=employees.filter(e=>e.id!==id);
  if(employees.length<before){msg.textContent="Employee deleted.";msg.style.color="#27ae60";}
  else{msg.textContent="Employee ID not found.";msg.style.color="#e74c3c";}
  msg.style.display="block";refreshEmpTable();refreshStats();
}
function refreshEmpTable(){
  const body=document.getElementById("empTableBody");body.innerHTML="";
  employees.forEach(e=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${e.id}</td><td>${e.name}</td><td>${e.dept}</td><td>${e.baseSalary.toFixed(2)}</td>`;
    tr.onclick=()=>{
      document.getElementById("empId").value=e.id;
      document.getElementById("empName").value=e.name;
      document.getElementById("empDept").value=e.dept;
      document.getElementById("empBaseSalary").value=e.baseSalary;
    };
    body.appendChild(tr);
  });
}
function markAttendance(){
  const id=document.getElementById("attEmpId").value.trim();
  const date=document.getElementById("attDate").value;
  const status=document.getElementById("attStatus").value;
  const msg=document.getElementById("attMsg");
  if(!id||!date){msg.textContent="Please enter Employee ID and Date.";msg.style.display="block";msg.style.color="#e74c3c";return;}
  const emp=employees.find(e=>e.id===id);
  if(!emp){msg.textContent="Employee not found. Add employee first.";msg.style.display="block";msg.style.color="#e74c3c";return;}
  attendance.push({id,date,status});
  msg.textContent="Attendance saved.";msg.style.display="block";msg.style.color="#27ae60";
  refreshAttTable();refreshStats();
}
function refreshAttTable(){
  const body=document.getElementById("attTableBody");body.innerHTML="";
  attendance.slice(-20).forEach(a=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${a.id}</td><td>${a.date}</td><td>${a.status}</td>`;
    body.appendChild(tr);
  });
}
function calculateSalary(){
  const id=document.getElementById("salEmpId").value.trim();
  const month=parseInt(document.getElementById("salMonth").value);
  const year=parseInt(document.getElementById("salYear").value);
  const result=document.getElementById("salaryResult");
  if(!id||isNaN(month)||isNaN(year)){result.textContent="Please enter employee ID, month and year.";return;}
  const emp=employees.find(e=>e.id===id);
  if(!emp){result.textContent="Employee not found.";return;}
  const records=attendance.filter(a=>{
    const d=new Date(a.date);
    return a.id===id && d.getMonth()+1===month && d.getFullYear()===year;
  });
  let absent=0,half=0;
  records.forEach(r=>{if(r.status==="Absent")absent++;if(r.status==="Half-day")half++;});
  const base=emp.baseSalary,perDay=base/30,ded=absent*perDay+half*(perDay/2),net=base-ded;
  result.innerHTML=
   `<strong>Salary Slip for ${emp.name} (${emp.id})</strong><br>
    Month/Year: ${month}/${year}<br>
    Department: ${emp.dept}<br><br>
    Base Salary: ${base.toFixed(2)}<br>
    Absent Days: ${absent}<br>
    Half Days: ${half}<br>
    Total Deduction: ${ded.toFixed(2)}<br>
    <strong>Net Payable: ${net.toFixed(2)}</strong>`;
}
function addLeave(){
  const id=document.getElementById("leaveEmpId").value.trim();
  const type=document.getElementById("leaveType").value;
  const start=document.getElementById("leaveStart").value;
  const end=document.getElementById("leaveEnd").value;
  const reason=document.getElementById("leaveReason").value.trim();
  const msg=document.getElementById("leaveMsg");
  if(!id||!start||!end){msg.textContent="Please fill Employee ID, Start and End date.";msg.style.display="block";msg.style.color="#e74c3c";return;}
  const emp=employees.find(e=>e.id===id);
  if(!emp){msg.textContent="Employee not found. Add employee first.";msg.style.display="block";msg.style.color="#e74c3c";return;}
  const leaveId="L"+(leaves.length+1).toString().padStart(3,"0");
  leaves.push({leaveId,empId:id,type,start,end,reason,status:"Pending"});
  msg.textContent="Leave request submitted.";msg.style.display="block";msg.style.color="#27ae60";
  refreshLeaveTable();refreshStats();
}
function changeLeaveStatus(id,status){
  const l=leaves.find(x=>x.leaveId===id);if(!l)return;
  l.status=status;refreshLeaveTable();refreshStats();
}
function refreshLeaveTable(){
  const body=document.getElementById("leaveTableBody");body.innerHTML="";
  leaves.forEach(l=>{
    const cls=l.status==="Approved"?"approved":l.status==="Rejected"?"rejected":"pending";
    const tr=document.createElement("tr");
    tr.innerHTML=
      `<td>${l.leaveId}<br><small>${l.empId}</small></td>
       <td>${l.type}</td>
       <td>${l.start} → ${l.end}</td>
       <td><span class="badge ${cls}">${l.status}</span></td>
       <td>
         <button style="margin-bottom:4px;" onclick="changeLeaveStatus('${l.leaveId}','Approved')">Approve</button>
         <button class="danger" onclick="changeLeaveStatus('${l.leaveId}','Rejected')">Reject</button>
       </td>`;
    body.appendChild(tr);
  });
}
function refreshStats(){
  document.getElementById("statEmployees").textContent=employees.length;
  document.getElementById("statAttendance").textContent=attendance.length;
  document.getElementById("statPendingLeaves").textContent=leaves.filter(l=>l.status==="Pending").length;
}
function refreshAllTables(){refreshEmpTable();refreshAttTable();refreshLeaveTable();refreshStats();}
window.onload=function(){
  const today=new Date().toISOString().split("T")[0];
  ["attDate","leaveStart","leaveEnd"].forEach(id=>{
    const el=document.getElementById(id);if(el)el.value=today;
  });
};
</script>
</body>
</html>
